/*! gratify 1.0.0 2022-11-05 5:11 AM */
var __gfy_version__="1.0.0";function asert(t,e){if("object"==typeof e&&e.indexOf){if(-1===e.indexOf(typeof t))throw new TypeError("Bad parameter of type "+typeof t+", expecting "+e.join(", "))}else if(typeof t!==String(e))throw new TypeError("Bad parameter of type "+typeof t+", expecting "+e)}function GratifyMain(){var a=this;this.default_system_service="sys",this.ready=!1,this.config={},this.error_callback=null,this.version=0,this.error_exists=!1,this.last_error="",this.endpoint="",this.authbound=!1,this.components={},this.init=function(t){if(a.ready)return!0;try{asert(t,["object","undefined"])}catch(t){return a.error(t.message,"Main::init")}t&&(a.config=t);t=$('script[src*="gratify-"]');if(0==t.length)return a.error("could not locate gratify script tag","Main::init");a.dictionary=new GratifyDictionary,a.thread=new GratifyThread,a.web=new GratifyWeb,a.app=new GratifyApp;var e=t.attr("src"),t=t.attr("system-service")?t.attr("system-service"):a.default_system_service,e=e.match(/^(https?:\/\/[^\/]+\/)([a-z\d\-]*\/)?/i);a.endpoint=String(e?e[1]+e[2]:a.app.base||"").replace(/\/$/,"")+"/"+t,a.client=new GratifyClient,a.cmanager=new GratifyCManager,a.scanner=new GratifyScanner,a.router=new GratifyRouter,a.ready=!0},this.q=function(t){return $?t?$(t):$:a.error("bad dom framework (missing jquery)","Main::q")},this.info=function(){console.log("version: "+a.version),console.log("jquery version: "+jQuery().jquery),console.log("dictionary size: "+JSON.stringify(a.dictionary.definitions).length),console.log("component count: "+Object.keys(a.cmanager.components).length),console.log("thread count: "+Object.keys(a.thread.intervals).length),console.log("thread density: "+function(){var t,e=0;for(t in a.thread.intervals)e+=1/a.thread.intervals[t].frequency;return e}().toFixed(3)+" / sec")},this.setErrorCallback=function(t){try{asert(t,"function")}catch(t){return a.error(t.message,"Main::setErrorCallback")}a.error_callback=t},this.error=function(t,e){return e="string"!=typeof e?"":e,t="object"==typeof t?JSON.stringify(t):String(t),a.last_error=t,a.error_exists=!0,console.error("Gratify Error"+(e?" ("+e+")":"")+": "+t),a.error_callback&&a.error_callback(t,e),!1},this.say=function(t){a.config.loud&&console.log('Gratify says, "'+("object"==typeof t?JSON.stringify(t):String(t))+'"')},this.request=function(t,e,r,n){return a.web.request(t,e,r,n)},this.def=function(t,e){return void 0===e?a.dictionary.lookup(t):a.dictionary.define(t,e)},this.goto=function(t,e){a.router.goto(t,e)},this.bindauth=function(e,t){try{asert(e,"string"),asert(t,["undefined","function"])}catch(t){return a.error(t.message,"Main::bindauth")}a.request("post "+a.endpoint+"/bindauth",{sid:e},function(t){if(t.errno)return a.error(t.error);1==t.payload&&(a.authbound=!0,a.say("authorization success: "+e))},t)},this.plugin=function(t,e,r){try{asert(t,"string"),asert(e,"string"),asert(r,["undefined","object"])}catch(t){return a.error(t.message,"Main::plugin")}r=JSON.stringify(r||{}).replaceAll('"',"&quot;");var n=$(t);if(!n.length)return a.error("plugin target '"+t+"' does not exist");n.html('<div gfy-plugin="'+e+"("+r+')" />')},this.spawn=function(t,e){try{asert(t,"object"),asert(e,["undefined","object"])}catch(t){return a.error(t.message,"Main::spawn")}return a.cmanager.spawn(t,e)},this.drop=function(t){return a.cmanager.drop(t)},this.get=function(t){return a.cmanager.get(t)},this.find=function(t){return this.q(t)},this.waitFor=function(e,r){try{asert(e,"string"),asert(r,"function")}catch(t){return a.error(t.message,"Main::waitFor")}var n="wait-for-"+Math.floor(Math.random()*Math.floor(5e3)),i=0;a.thread.start(function(){var t=a.q(e);t.length&&(r(t),i=500),500<=i&&a.thread.stop(n),i++},n,.2)}}function GratifyDictionary(){var f=this;this.definitions={},this.lookup=function(t){var e;try{asert(t,"string"),e=f.explode(t)}catch(t){return gratify.error(t.message,"Dictionary::lookup")}var r,n=null;for(r in e){var i=e[r];if(null===n){if(void 0===f.definitions[i])return"";n=JSON.parse(JSON.stringify(f.definitions[i]))}else n=n[i];if("object"!=typeof n)break;if(void 0===n)return""}return n},this.define=function(t,e){var r;try{asert(t,"string"),asert(e,["string","object","number"]),r=f.explode(t)}catch(t){return gratify.error(t.message,"Dictionary::define")}var n,i=f.definitions,a=!0;for(n in r){var o=r[n];if(n==r.length-1){if(Array.isArray(e)&&(e=Object.assign({},e)),JSON.stringify(i[o])===JSON.stringify(e)){a=!1;break}i[o]=e;break}i=("object"!=typeof i[o]&&(i[o]={}),i[o])}if(a){gratify.say("definition of "+t+" updated");for(var s=r.length-1;0<=s;s--){for(var c in gratify.cmanager.components){c=gratify.cmanager.components[c];-1!==$.inArray(t,c.$udefs)&&gratify.cmanager.queue(c.$id)}t=t.replace(new RegExp("\\."+r[s]+"$"),"")}}},this.explode=function(t){if((t=String(t)).match(/^[a-z\d_\-\.]+$/i)&&-1===t.indexOf(".."))return t.split(".");throw new TypeError("invalid definition name; only letters, numbers, dashes, and underscores are allowed")}}function GratifyCManager(){var u=this;this.components={},this.updateQueue=[],this.spawn=function(t,n){var i,e,r,a,o;try{asert(t,"object"),asert(t.$id,"string"),i="string"==typeof(n="object"==typeof n?n:{}).id?n.id:t.$id,e="string"==typeof t.$htdoc?t.$htdoc:null,r="object"==typeof t.$htargs?t.$htargs:{},a="string"==typeof t.$target?t.$target:null,o="object"==typeof n.parent?n.parent:null,asert(n.target,["undefined","object","string"]),a=n.target||a}catch(t){return gratify.error(t.message,"CManager::spawn")}if(void 0!==u.components[i]){for(var s,c=i.match(/-\d+$/)?parseInt(i.match(/\d+$/)[0]):0;c++,s=i.replace(/-\d+$/,"")+"-"+c,void 0!==u.components[s];);i=s}try{gratify.say("spawning new component <"+i+">");var f,p=new GratifyComponent(t);p.$id=i,u.components[i]=p,e?(f=Boolean(-1!==e.indexOf("--before")),gratify.request("get "+e,r,function(t){p.$container=$(t),p.$container.attr("id",i),p.$stems=[];var e=p.$container.find(".-dev-stem").toArray();if(e.length){e.reverse();for(var r=0;r<e.length;r++)e[r].classList.remove("-dev-stem"),p.$stems.push(e[r]),e[r].parentNode&&e[r].parentNode.removeChild(e[r])}p.$container.is(".-dev-stem")&&(p.$container.removeAttr("id"),p.$container.removeClass("-dev-stem"),p.$stems.push(p.$container[0]),p.$container=null),p.$stems.reverse(),o&&(p.$parent=o),a&&(p.$target||(p.$target=a),p.$container)&&(p.$container.find(".-dev-stem").remove(),f?p.$container.prependTo(a):p.$container.appendTo(a)),p.$create(n)})):p.$create(n)}catch(t){return gratify.error(t.message,"CManager::spawn")}return gratify.say("new component ready <"+i+">"),u.components[i]},this.drop=function(t){return"object"==typeof t&&"string"==typeof t.$id&&(t=t.$id),"object"==typeof u.components[t]&&(u.components[t].$destroy(),delete u.components[t],gratify.say("dropped component <"+t+">"),!0)},this.get=function(t){return u.components[t]},this.queue=function(t){-1===$.inArray(t,u.updateQueue)&&(u.updateQueue.push(t),gratify.say("component "+t+" queued for update"))},gratify.thread.start(function(){for(var t in u.updateQueue){var e=u.updateQueue[t],e=gratify.get(e);e&&(e.$update(),gratify.say("component "+e.$id+" updated")),delete u.updateQueue[t]}},"cmanager.queue",.2)}function GratifyComponent(t){var e,r=this;for(e in asert(t,"object"),t){var n=t[e];switch(e){case"$create":case"$destroy":case"$draw":case"$update":asert(n,"function");break;case"$spawn":case"$ready":case"$rendered":throw"user cannot define "+e}r[e]=n}this.hasOwnProperty("$create")||(this.$create=function(){}),this.hasOwnProperty("$destroy")||(this.$destroy=function(){}),this.hasOwnProperty("$htdoc")&&(this.$reset=function(e){gratify.request("get "+r.$htdoc,r.$htargs||{},function(t){r.$container=$(t),r.$container.attr("id",r.$id),"function"==typeof e&&e(r.$container)})}),this.$spawn=function(t,e){return asert(t,"object"),e="object"==typeof e?e:{},gratify.spawn(t,Object.assign(e,{parent:this}))},this.$ready=function(t){asert(t,"function"),gratify.waitFor("#"+this.$id,t)},this.$rendered=function(){return Boolean($("#"+this.$id).length)}}function GratifyApp(){var t,n=this;this.params={},this.path=document.location.pathname,this.query=document.location.search,this.zoomlvl=100,this.cursor_x=0,this.cursor_y=0,this.version_tag="",this.site_name="",this.namespace=document,this.setVersionTag=function(t){if(!(t=String(t)).match(/^[a-z\d]+$/))return gratify.error("invalid tag value","App::setHash");n.version_tag=t},this.setSiteName=function(t){n.site_name=String(t)},this.include=function(t,e,r){try{asert(t,"string"),asert(e,"string")}catch(t){return gratify.error(t.message,"App::include")}var n;switch(t){case"script":(n=document.createElement("script")).async=!0,n.id="string"==typeof r?r:void 0,n.src=e.appendAppHash();break;case"css":(n=document.createElement("link")).type="text/css",n.rel="stylesheet",n.id="string"==typeof r?r:void 0,n.href=e.appendAppHash();break;default:return gratify.error("bad resource type","App::include")}$(document).find("head").append(n)},this.exclude=function(t){$("script#"+t+", link#"+t).remove()},this.sense=function(t){if(t||document.location.search!=n.query){t=location.search.split("?");if(1<t.length)for(var e in params=t[1].split("&"))(paramParts=params[e].split("="))[1]&&(n.params[paramParts[0]]=decodeURIComponent(paramParts[1].replace(/\+/g,"%20")))}try{$(window).trigger("resize"),n.zoomlvl=Math.round(100*window.devicePixelRatio)}catch(t){n.zoomlvl=100}},(t=$("html > head")).length&&(t=t.find("base")).length&&(n.base=t.attr("href").replace(/\/+$/,"")),$(document).on("mousemove",function(t){n.cursor_x=t.pageX,n.cursor_y=t.pageY}),$(window).on("resize",function(t){try{var e=parseInt(window.innerWidth),e=isNaN(e)||e<0?0:e,r="xs";1400<=e?r="xxl":1200<=e?r="xl":992<=e?r="lg":768<=e?r="md":576<=e&&(r="sm"),n.breakpoint=r}catch(t){n.breakpoint="xs"}}),n.sense(!0)}function GratifyWeb(){var p=this;this.max_tries=5,this.wait=1,this.call_stack={},this.setWait=function(t){try{asert(t,"number")}catch(t){gratify.error(t.message,"Web::setWait")}p.wait=t},this.request=function(t,e,n,r){try{e=void 0===e?{}:e,n=void 0===n?function(){}:n,r=void 0===r?function(){}:r,asert(t,"string"),asert(e,"object"),asert(n,"function"),asert(r,"function")}catch(t){return gratify.error(t.message,"Web::request")}var i=t.match(/^(get|post|put|delete|file) (\S*)(( --?[a-z-]+)*)$/i);if(!i)return gratify.error("bad request string: "+t,"Web::request");var t=btoa(t+btoa(JSON.stringify(e))),t=(void 0===p.call_stack[t]&&(p.call_stack[t]={tries:0}),p.call_stack[t].tries++,i[1].toLowerCase()),a=i[2],i=(a.match(/^\//)&&gratify.app.base&&(a=gratify.app.base+a),i[3].trim().split(" ")),o=("get"===t&&e&&Object.keys(e).length&&(-1===a.indexOf("?")&&(a+="?"),a+=$.param(e)),Boolean(-1!==i.indexOf("--cache"))),s=Boolean(-1!==i.indexOf("--version")||-1!==i.indexOf("-v")),i=Boolean(-1===i.indexOf("--block")),c=Math.randint(100,999),f=(gratify.say("starting "+t.toUpperCase()+" request #"+c+" to "+a),null);"file"==t?f=e:"post"==t&&(-1!==e.toString().indexOf("FormData")?(f={},e.forEach(function(t,e){f[e]=t})):f=e),$.ajax({url:s?a.appendVersionTag():a,data:f,method:"get"==t?"get":"post",async:i,cache:o,contentType:"file"!=t&&"application/x-www-form-urlencoded; charset=UTF-8",processData:"file"!=t,dataType:"text",xhrFields:{withCredentials:!0},success:function(t,e,r){gratify.say("#"+c+" responded "+r.status+" "+r.statusText);try{t=JSON.parse(t)}catch(t){}finally{n(t)}},error:function(t,e){return gratify.error("http request error [status:"+t.status+"; response:"+t.responseText+"]","Web::request")},complete:r})}}function GratifyThread(){var n=this;this.intervals={},this.start=function(t,e,r){try{asert(t,"function")}catch(t){return gratify.error(t.message,"Thread::start")}return"string"!=typeof e&&(e=(new Date).getTime()),"number"!=typeof r&&(r=1),void 0===n.intervals[e]&&(n.intervals[e]={id:setInterval(t,1e3*r),frequency:r},t()),e},this.stop=function(t){void 0!==n.intervals[t]&&(clearInterval(n.intervals[t].id),delete n.intervals[t])}}function GratifyScanner(){var n=this;this.elements=[],this.tags=["gfy-var","gfy-goto","gfy-plugin"],gratify.thread.start(function(){for(var t in n.tags){t=n.tags[t];$("["+t+"]").each(function(t,e){-1===$.inArray(e,n.elements)&&n.elements.push(e)})}for(var e in n.elements){var r=gratify.app.namespace;(r="ie"==gratify.client.browser&&r==document?document.body:r).contains(n.elements[e])||n.elements.splice(e,1)}},"gratify-scanner-absorb-dom",.2),gratify.thread.start(function(){for(var t in n.elements){var u=$(n.elements[t]),t=u.attr("gfy-var");t&&(t=gratify.def(t),u.html()!=t)&&u.html(t);!u.attr("gfy-goto")||u.prop("gfy-goto-active")||u.prop("gfy-goto-active",!0).on("click",function(){gratify.goto($(this).attr("gfy-goto"))});t=u.attr("gfy-plugin");if(t&&!u.prop("gfy-plugin-loaded")){var e=t.match(/^([a-z\d-]+)\.([a-z\d-]+)(\((.*)\))?$/);if(!e)return u.prop("gfy-plugin-loaded",!0),console.error("invalid gratify plugin: "+t);if("true"===String(u.attr("gfy-wait-for-auth"))&&!gratify.authbound)return;var t=e[1],r=e[2],e=e[4];if(e)try{e=JSON.parse(e)}catch(t){console.error("could not parse plugin parameters: "+t.message)}(e="object"!=typeof e?{}:e).namespace=t,e.plugin=r,e.json=1,gratify.request("get "+gratify.endpoint+"/plugin",e,function(t){if(t.errno)return console.error(t.error);try{var e=gratify.app.namespace,r=t.payload.html,n=t.payload.css,i=t.payload.meta,a=i.namespace,o=i.component_name,s=i.plugin_name,c=t.payload.js;if(r&&u.html(r),n&&$(e).find("head").append("<style>"+n+"</style>"),c){"object"!=typeof gratify.components[a]&&(gratify.components[a]={}),$(e).find("head").append("<script>"+c+"<\/script>");var f=gratify.components[a][o];if("object"!=typeof f)throw{message:"component js missing object definition '"+a+"."+o+"'"};f.$id=o;var p=gratify.spawn(f);p&&(p.$container=u.find("."+s))}}catch(t){console.error("error loading plugin: "+t.message,t)}}),u.prop("gfy-plugin-loaded",!0)}}},"gratify-scanner-event-handler",.2)}function GratifyClient(){var t,e=this;this.browser="unknown",this.device="unknown",this.platform="unknown",this.platver="unknown",this.isMobile=function(){return"phone"==e.device||"tablet"==e.device},(t=navigator.userAgent).match(/^Mozilla\/.+Edge\/.+$/)?e.browser="edge":t.match(/^Mozilla\/.+(Chrome\/|CriOS\/).+$/)?e.browser="chrome":t.match(/^Mozilla\/.+Trident\/.+$/)?e.browser="ie":t.match(/^Mozilla\/.+Gecko\/.+Firefox\/.+$/)?e.browser="firefox":t.match(/^Mozilla\/.+AppleWebKit\/.+Safari\/.+$/)&&(e.browser="safari"),t.match(/Windows NT/)?e.platform="win":t.match(/Android/)?e.platform="android":t.match(/(iOS|iPhone|iPad)/)?e.platform="ios":t.match(/Mac OS/)?e.platform="mac":t.match(/Linux/)&&(e.platform="linux"),"win"==e.platform&&(matches=t.match(/Windows NT ([\d\.]+)/))&&(e.platver=matches[1]),t.match(/Tablet|iPad/)&&"win"!=e.platform||"android"==e.platform&&!t.match(/Mobile/)?e.device="tablet":t.match(/Mobile|iPhone/)?e.device="phone":"win"!=e.platform&&"mac"!=e.platform||(e.device="desktop")}function GratifyRouter(){var r=this;this.started=!1,this.myRoute="",this.routes={},this.strict=!1,this.start=function(t,e){if(e="object"==typeof e?e:{},strict=Boolean(e.strict),auto=Boolean(e.auto),r.started)return!1;try{asert(t,"object")}catch(t){return gratify.error(t.message,"Router::start")}return r.routes=t,window.addEventListener("popstate",function(t){t=t.target.location;r.goto(t.pathname+(t.hash||""),!1)}),strict&&(r.strict=!0),r.started=!0,gratify.say("router started with "+Object.keys(t).length+" nodes"),auto&&r.resolve(e),!0},this.resolve=function(t){var e=location.pathname+(location.search||"")+(location.hash||"");gratify.say("resolving "+e),r.goto(e,!1)},this.back=function(){r.goto(r.lastRoute)},this.goto=function(t,e){var r=this;try{e=void 0!==e&&e,asert(t,"string")}catch(t){return gratify.error(t.message,"Router::goto")}var n,i=gratify.app.base||"",a=(-1!==(t=t.replace(i,"").replace(/\/+$/,"")||"/").indexOf("#")&&(t=t.split("#")[0]),gratify.say("routing to "+t),""),o="",s=null,c=null,f={},p=[],u=[],l="",d="";for(n in o=t.split("?")[0],r.routes)if(n.match(/\*$/)){if(1<n.split("*").length-1)return gratify.error("too many route wildcards; only 1 allowed");var g=o.match(new RegExp("^"+n.replace("*","(.*)"),"i"));if(g&&g.length){var y,o=r.routes[n],h=g[1].split("/");for(y in h)h[y]&&(f[y]=h[y])}}else o.toLowerCase()==n.toLowerCase()&&(o=r.routes[n]);if(s=1<(u=(p=o.split("?"))[0].split("/")).length?u[1].toLowerCase():r.strict?null:"main",c=2<u.length?u[2].toLowerCase():r.strict?null:"index"){var m,v="",$=c.split("-");for(m in $)l=$[m],v+=0<m?l.charAt(0).toUpperCase()+l.slice(1):l.charAt(0)+l.slice(1);d&&(d+="-"),d+=c=v}if(1<p.length)for(var b=p[1].split("&"),w=0;w<b.length;w++){var x=b[w].split("=")[0],j=b[w].split("=")[1]||!0;f[x]="0"===j?0:j}"string"==typeof f.page_title&&(u=f.page_title.trim(),gratify.app.site_name&&(u=u+" | "+gratify.app.site_name.trim()),document.title=u);var _,S="",O=s.split("-");for(_ in O)S+=(l=O[_]).charAt(0).toUpperCase()+l.slice(1);p=gratify.get(S);if(!p)return u="component "+S+" does not exist","Default"==S&&(u+="; please check your routes"),gratify.error(u,"Router::goto");if("function"!=typeof p[c])return gratify.error('action "'+c+'" does not exist for '+S,"Router::goto");t!=r.myRoute&&(e?window.history.pushState(f,d,i+t):window.history.replaceState(f,d,i+t),r.lastRoute=r.myRoute,r.myRoute=t);try{a=p[c](f)}catch(t){a=!1,gratify.error("exception: "+t.message,"Router::goto")}return gratify.app.sense(),a}}"function"!=typeof Object.assign&&(Object.assign=function(t,e){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e=[]);var r,n=JSON.parse(JSON.stringify(t));for(r in e)n[r]=e[r];return n}),"function"!=typeof Math.randint&&(Math.randint=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}),String.prototype.padStart||(String.prototype.padStart=function(t,e){return t>>=0,e=String(void 0!==e?e:" "),this.length>=t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){return Boolean(-1<Array(this).indexOf(t,e))}}),String.prototype.rot13||(String.prototype.rot13=function(){return String(this).replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+13)?t:t-26)})}),String.prototype.appendVersionTag||(String.prototype.appendVersionTag=function(){var t=String(this);return""!=gratify.app.version_tag&&(-1===t.indexOf("?")?t+="?":t+="&",t+="_="+encodeURIComponent(gratify.app.version_tag)),t}),Number.prototype.byteshr||(Number.prototype.byteshr=function(){for(var t=this.valueOf(),e=[" Bytes"," KB"," MB"," GB"],r=1;r<e.length;r++)if(t<Math.pow(1024,r))return Math.round(t/Math.pow(1024,r-1)*100)/100+e[r-1];return t}),String.prototype.clipboard||(String.prototype.clipboard=function(){var t=String(this),e=$("<input>"),r=($("body").append(e),e.val(t).select(),document.execCommand("copy"),e.remove(),$('<div class="gfy-text-copied">Text copied!</div>'));r.css({position:"fixed",left:gratify.app.cursor_x+3+"px",top:gratify.app.cursor_y-28+"px",zIndex:101,fontSize:"12px",opacity:.7}),$("body").append(r),setTimeout(function(){setTimeout(function(){r.fadeOut(200),setTimeout(function(){r.remove()},200)},200)},300)}),jQuery.fn.extend({selectMe:function(){var t=$(this)[0],e=document.createRange(),t=(e.setStartBefore(t.firstChild),e.setEndAfter(t.lastChild),window.getSelection());t.removeAllRanges(),t.addRange(e)}});var gratify,min_jq_ver=3.1;"undefined"==typeof jQuery?console.error("could not load gratify; missing jQuery"):parseFloat(jQuery().jquery.substr(0,3))<min_jq_ver?console.error("could not load gratify; jQuery version too old -- requires at least "+min_jq_ver+".x"):($!==jQuery&&($=jQuery),(gratify=new GratifyMain).version=__gfy_version__,gratify.init());